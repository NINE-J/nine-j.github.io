---
publish: true
 draft: false
title: íŠ¸ëœì­ì…˜ ê²©ë¦¬ì„± - Isolation
description: ë™ì‹œì„± í™˜ê²½ì—ì„œ ë°ì´í„°ë¥¼ ì§€í‚¤ê¸° ìœ„í•œ ì „ëµ
author: Nine
date: 2025-06-15 17:31:13
categories:
  - DB
  - Transaction
tags:
  - devlog
  - íŠ¸ëœì­ì…˜
  - Transaction
  - ACID
  - Isolation
  - DirtyRead
  - Non-RepeatableRead
  - PhantomRead
  - ë™ì‹œì„±ì²˜ë¦¬
  - ì½ê¸°í˜„ìƒ

Status: Done
---
## ğŸ“Œê°œìš”

íŠ¸ëœì­ì…˜ì˜ ACID ì†ì„± ì¤‘ **Isolcation(ê²©ë¦¬ì„±)** ì€ ë‹¤ìˆ˜ì˜ íŠ¸ëœì­ì…˜ì´ ë™ì‹œì— ì‹¤í–‰ë  ë•Œ ê° íŠ¸ëœì­ì…˜ì´ ì„œë¡œì—ê²Œ ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ í†µì œí•˜ê¸° ìœ„í•œ í•µì‹¬ ìš”ì†Œì´ë©° ê°€ì¥ ë³µì¡í•˜ê³  ì´í•´í•˜ê¸° ì–´ë ¤ìš´ ì†ì„±ì´ë‹¤.

ê²©ë¦¬ ìˆ˜ì¤€ì´ ë³´ì¥í•˜ëŠ” ê²ƒì€ ë‹¨ìˆœíˆ ì¼ê´€ì„±ì´ ì•„ë‹ˆë¼ **ë°ì´í„° ë¬´ê²°ì„±ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ì˜ ì‹ ë¢°ì„±** ì´ë‹¤.
íŠ¹íˆ ë™ì‹œì„± í™˜ê²½ì—ì„œ ê²©ë¦¬ ìˆ˜ì¤€ì´ ë¶€ì¡±í•˜ë©´ ë°ì´í„°ëŠ” ê¼¬ì´ê³ , ê·¸ í”¼í•´ëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬ëœë‹¤.

ì´ë²ˆ ê¸€ì—ì„œ ì •ë¦¬í•˜ëŠ” ê±´ ëª¨ë‘ ì´í•´í•˜ê³  ì‘ì„±í•  ìˆ˜ ì—†ì–´ì„œ ê´€ë ¨ ìë£Œë¥¼ ì •ë¦¬í•œ í›„ ìƒì„¸í•œ ë‚´ìš©ì— ëŒ€í•´ ë” ê¹Šê²Œ íŒŒê³ ë“¤ ì˜ˆì •ì´ë‹¤.

ê²©ë¦¬ì„±ì´ ë¬´ë„ˆì§€ë©´ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œë“¤ì„ ì˜ˆì œë¡œ ì„¤ëª…í•˜ê³ , ì´ë¥¼ ë§‰ê¸° ìœ„í•´ ì¡´ì¬í•˜ëŠ” ê²©ë¦¬ ìˆ˜ì¤€ë“¤ì— ëŒ€í•´ ë‹¨ê³„ì ìœ¼ë¡œ ì •ë¦¬í•´ë³¸ë‹¤.

## ğŸ“Œë‚´ìš©

### ê²©ë¦¬ì„±ì€ ê¸°ë³¸ê°’ìœ¼ë¡œ ë³´ì¥ë˜ê³  ìˆì„ê¹Œ?

- ëŒ€ë¶€ë¶„ì˜ RDBMSì˜ ê¸°ë³¸ ê²©ë¦¬ ìˆ˜ì¤€ì€ `READ COMMITED` ë˜ëŠ” `REPEATABLE READ`ì´ì§€ë§Œ ì´ë¦„ì€ ê°™ì•„ë„ êµ¬í˜„ ë°©ì‹ê³¼ ë³´ì¥ ìˆ˜ì¤€ì€ ë‹¤ë¥´ë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ Oracleì˜ `SERIALIZABLE`ì€ ì‹¤ì œë¡  `SNAPSHOT ISOLATION`
- MySQLì˜ `REPEATABLE READ`ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Phantom Readë¥¼ ë°©ì§€í•˜ì§€ ì•Šìœ¼ë©°
- PostgreSQLì€ MVCC ê¸°ë°˜ì´ì§€ë§Œ `Serializable`ì„ ëª…ì‹œí•´ì•¼ë§Œ ì‹¤ì œ ì§ë ¬í™” ë³´ì¥ì„ í•œë‹¤.
    - MVCC: Multi-Version Concurrency Control, ë‹¤ì¤‘ ë²„ì „ ë™ì‹œì„± ì œì–´

ê²©ë¦¬ ìˆ˜ì¤€ì€ ì´ë¦„ì´ ê°™ë‹¤ê³  ê°™ì€ ê²Œ ì•„ë‹ˆë‹¤.
ë°˜ë“œì‹œ DBë³„ êµ¬í˜„ ë°©ì‹ì„ í™•ì¸í•´ì•¼ í•œë‹¤.

### ê²©ë¦¬ ìˆ˜ì¤€ì´ ê¹¨ì§ˆ ë•Œ ë²Œì–´ì§€ëŠ” í˜„ìƒë“¤

| ìœ í˜•                      | ì„¤ëª…                       | ì˜ˆì‹œ                                                          |
| ----------------------- | ------------------------ | ----------------------------------------------------------- |
| **Dirty Read**          | ì»¤ë°‹ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì½ìŒ          | Aê°€ ì†¡ê¸ˆ ì²˜ë¦¬ ì¤‘ì¸ë°, Bê°€ ì¤‘ê°„ ìƒíƒœì˜ ê¸ˆì•¡ì„ ì½ê³  í•©ì‚°í•˜ì—¬ ì¤‘ë³µ ì†¡ê¸ˆ ë°œìƒ                |
| **Non-Repeatable Read** | ë™ì¼ ì¡°ê±´ìœ¼ë¡œ ë‘ ë²ˆ ì¡°íšŒí–ˆëŠ”ë° ê²°ê³¼ê°€ ë‹¤ë¦„ | Aê°€ ìƒí’ˆ ì¬ê³ ë¥¼ ë‘ ë²ˆ ì¡°íšŒí•˜ëŠ” ì‚¬ì´, Bê°€ ì¬ê³ ë¥¼ ë³€ê²½í•¨                           |
| **Phantom Read**        | ê°™ì€ ì¿¼ë¦¬ì¸ë° í–‰ ê°œìˆ˜ê°€ ë‹¬ë¼ì§        | Aê°€ `"ë‚˜ì´ > 30"` ì¡°ê±´ìœ¼ë¡œ ì¡°íšŒ â†’ Bê°€ 35ì„¸ ì‚¬ìš©ìë¥¼ ì‚½ì… â†’ Aê°€ ë‹¤ì‹œ ì¡°íšŒí•˜ë©´ ê²°ê³¼ ë‹¬ë¼ì§ |

### ì‹¤ë¬´ì—ì„œ ì‹¤ì œ ë°œìƒí•œ ì‚¬ë¡€

- **ë™ì‹œ ì†¡ê¸ˆ ì‹œìŠ¤í…œì—ì„œì˜ ê²½ìŸ ì¡°ê±´**
    - ì‚¬ìš©ìê°€ ì”ì•¡ì´ 100ì¸ ìƒíƒœì—ì„œ ê±°ì˜ ë™ì‹œì— ë‘ ë²ˆ ì†¡ê¸ˆ ìš”ì²­ì„ ë³´ëƒ„
    - ë‘˜ ë‹¤ ì”ì•¡ ì¡°íšŒ ê²°ê³¼ 100ì„ ì½ê³ , ê°ê° 80ì„ ì†¡ê¸ˆ â†’ ì´ 160 ì†¡ê¸ˆë¨
    - ì´ìœ : `READ COMMITTED` ìƒíƒœì—ì„œëŠ” ë‘ íŠ¸ëœì­ì…˜ì´ ì„œë¡œë¥¼ ê³ ë ¤í•˜ì§€ ëª»í•¨
- **í•´ê²°ì±…ì€?**
    - `SERIALIZABLE` ìˆ˜ì¤€ì˜ ê²©ë¦¬ ë˜ëŠ” **ì• í”Œë¦¬ì¼€ì´ì…˜ ì°¨ì›ì˜ ë½** ì ìš©

### ANSI SQL ê²©ë¦¬ ìˆ˜ì¤€ ë¹„êµí‘œ

>[!WARNING]
>ê²©ë¦¬ ìˆ˜ì¤€ì„ ì˜¬ë¦¬ë©´ ì˜¤ë¥˜ëŠ” ì¤„ì§€ë§Œ, ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤.

ê²©ë¦¬ ìˆ˜ì¤€ 4ê°€ì§€ì™€ ì´ì— ë”°ë¥¸ í˜„ìƒ 3ê°€ì§€ê°€ ìˆë‹¤.
ì´ 3ê°€ì§€ í˜„ìƒì„ ì½ê¸° í˜„ìƒ(Read Phenomena)ë¼ê³  í‘œí˜„í•œë‹¤.

- **Dirty Read**: ì»¤ë°‹ë˜ì§€ ì•Šì€(trash) ë°ì´í„°ë¥¼ ì½ëŠ” í˜„ìƒ
- **Non-Repeatable Read**: ê°™ì€ ì¿¼ë¦¬ë¥¼ ë‘ ë²ˆ ì‹¤í–‰í–ˆì„ ë•Œ ê²°ê³¼ê°€ ë‹¬ë¼ì§€ëŠ” í˜„ìƒ
- **Phantom Read**: ë™ì¼ ì¡°ê±´ì˜ ì¿¼ë¦¬ì—ì„œ í–‰ ê°œìˆ˜ê°€ ë‹¬ë¼ì§€ëŠ” í˜„ìƒ (ì‚½ì…/ì‚­ì œë¡œ ì¸í•´)

| ê²©ë¦¬ ìˆ˜ì¤€                | Dirty Read | Non-Repeatable Read | Phantom Read | ë¹„ê³                                     |
| -------------------- | ---------- | ------------------- | ------------ | ------------------------------------- |
| **READ UNCOMMITTED** | í—ˆìš©         | í—ˆìš©                  | í—ˆìš©           | ìµœì € ì„±ëŠ¥, ì‹¤ì‚¬ìš© ê±°ì˜ ì—†ìŒ                      |
| **READ COMMITTED**   | ë°©ì§€         | í—ˆìš©                  | í—ˆìš©           | ëŒ€ë¶€ë¶„ DBì˜ ê¸°ë³¸ê°’                           |
| **REPEATABLE READ**  | ë°©ì§€         | ë°©ì§€                  | í—ˆìš©           | MySQL ê¸°ë³¸ê°’ (í•˜ì§€ë§Œ Phantom Read ë°©ì§€ëŠ” ë¶ˆì™„ì „í•¨) |
| **SERIALIZABLE**     | ë°©ì§€         | ë°©ì§€                  | ë°©ì§€           | ê°€ì¥ ê°•ë ¥í•˜ë‚˜ ì„±ëŠ¥ ì €í•˜ ìˆìŒ                      |

### Springì—ì„œì˜ ì„¤ì • ë°©ë²•

```java
@Transactional(isolation = Isolation.SERIALIZABLE)
public void processTransaction() {
    ...
}
```

- `Isolation.DEFAULT`: DBMS ê¸°ë³¸ ì„¤ì • ë”°ë¦„
- í”„ë¡œì íŠ¸ì— ë”°ë¼ `.yml`, `.yaml` ë˜ëŠ” DB ì„¤ì •ì—ì„œ ì „ì—­ ê¸°ë³¸ê°’ì„ ì¡°ì •í•  ìˆ˜ë„ ìˆìŒ
- íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•  ë•Œ `@Transactional`ë§Œ ì„ ì–¸í•˜ê³  ëì´ ì•„ë‹ˆë¼ ì–´ë–¤ `isolation level`ì´ ì ìš©ë˜ëŠ”ì§€ ì•Œì•„ë³¸ë‹¤ë©´ ì¢‹ì„ ê²ƒì´ë‹¤.

## ğŸ¯ê²°ë¡ 

**íŠ¸ëœì­ì…˜ì€ ì„ ì–¸ë§Œìœ¼ë¡œ ì•ˆì „í•˜ì§€ ì•Šë‹¤.**

ê²©ë¦¬ ìˆ˜ì¤€ì€ ì½”ë“œì˜ ë™ì‘ ë°©ì‹ê³¼ ë°ì´í„° ì‹ ë¢°ì„±ì„ ê²°ì •ì§“ëŠ” ì¤‘ìš”í•œ ìš”ì†Œë‹¤.  
ë¬¸ì œë¥¼ ê²ªê³  ë‚˜ì„œì•¼ "ì™œ ë°ì´í„°ê°€ ê¼¬ì˜€ì§€?"ë¥¼ ê³ ë¯¼í•˜ê¸°ë³´ë‹¤, ë¯¸ë¦¬ ê²©ë¦¬ ìˆ˜ì¤€ì„ ì„¤ì •í•˜ê³  ì´í•´í•˜ëŠ” ê²ƒì´ í›¨ì”¬ ê°’ì§€ë‹¤.

## âš™ï¸EndNote

### ì‚¬ì „ ì§€ì‹

- íŠ¸ëœì­ì…˜ê³¼ ì»¤ë°‹/ë¡¤ë°±ì˜ ê°œë…
- DB ë½: Shared Lock vs Exclusive Lock
- MVCC(Multi-Version Concurrency Control)
- [Read Phenomena in Transactions by oim_](https://oimbook.tistory.com/entry/Read-Phenomena-in-Transactions)

### ë” ì•Œì•„ë³´ê¸°

- [PostgreSQL ê³µì‹ ë¬¸ì„œ: Isolation Levels](https://www.postgresql.org/docs/current/transaction-iso.html)
- [MySQL InnoDB íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€](https://dev.mysql.com/doc/refman/8.0/en/innodb-transaction-isolation-levels.html)
- [Spring Declarative Transaction Management](https://docs.spring.io/spring-framework/reference/data-access/transaction/declarative.html)
- [Hermitage: Testing the â€œIâ€ in ACID](https://martin.kleppmann.com/2014/11/25/hermitage-testing-the-i-in-acid.html)
- [I-9. í‘œì¤€ SQL ì´ë€?](https://sesoc.tistory.com/317)
- [Isolation (database systems)](https://en.wikipedia.org/wiki/Isolation_(database_systems))
