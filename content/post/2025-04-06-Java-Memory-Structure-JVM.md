---
publish: true
draft: false
title: "Java ì‹¤í–‰ í™˜ê²½: JVM ë©”ëª¨ë¦¬ êµ¬ì¡°ì˜ ì´í•´"
description: JVM ë©”ëª¨ë¦¬ êµ¬ì¡°ì˜ ì´í•´í•˜ê³  Javaë¥¼ ì‹¤í–‰í•˜ì.
author: Nine
date: 2025-04-06
categories:
  - Java
  - ëŸ°íƒ€ì„
tags:
  - devlog
# image: Status: Done
---
## ğŸ“Œê°œìš”

ìë°” ì†ŒìŠ¤ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” JVMì˜ ë©”ëª¨ë¦¬ êµ¬ì¡°ë¥¼ ì•Œì•„ë³¸ë‹¤.
JVMì€ ìë°” í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ê°€ìƒ ë¨¸ì‹ ìœ¼ë¡œ, í”Œë«í¼ ë…ë¦½ì„±ì„ ì œê³µí•˜ë©° ë©”ëª¨ë¦¬ ê´€ë¦¬, ìŠ¤ë ˆë“œ ë™ê¸°í™”, ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ë“±ì˜ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•œë‹¤.

## ğŸ“Œë‚´ìš©

### Java ì†ŒìŠ¤ ì‹¤í–‰

ìë°” ì†ŒìŠ¤ ì½”ë“œëŠ” `.java` íŒŒì¼ë¡œ ì €ì¥ë˜ë©°, ì´ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ìë°” ì»´íŒŒì¼ëŸ¬ `javac`ê°€ ë°”ì´íŠ¸ ì½”ë“œ(Byte code) `.class` íŒŒì¼ë¡œ ë³€í™˜í•˜ê²Œ ëœë‹¤.

ë°”ì´íŠ¸ ì½”ë“œëŠ” JVMì´ ì´í•´í•  ìˆ˜ ìˆëŠ” ì¤‘ê°„ í‘œí˜„ìœ¼ë¡œ, í”Œë«í¼ ë…ë¦½ì„±ì„ ì œê³µí•œë‹¤.
ë°”ì´íŠ¸ ì½”ë“œë¡œ ë³€í™˜í•˜ëŠ” ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

- **ë³´ì•ˆì„±**: ì†ŒìŠ¤ ì½”ë“œë¥¼ ì§ì ‘ ë…¸ì¶œí•˜ì§€ ì•Šê³  ë°”ì´íŠ¸ ì½”ë“œë¡œ ë³€í™˜í•¨ìœ¼ë¡œì¨ ì½”ë“œì˜ ë‚´ìš©ì„ ë³´í˜¸í•  ìˆ˜ ìˆë‹¤.
- **íš¨ìœ¨ì„±**: ì»´íŒŒì¼ ì‹œ ë¬¸ë²• ê²€ì‚¬ì™€ ìµœì í™”ë¥¼ ê±°ì¹˜ë¯€ë¡œ, ì‹¤í–‰ ì‹œ ì¶”ê°€ì ì¸ ë¬¸ë²• ê²€ì‚¬ê°€ í•„ìš” ì—†ì–´ ì‹œê°„ì´ ì ˆì•½ëœë‹¤.
- **í”Œë«í¼ ë…ë¦½ì„±:** ë°”ì´íŠ¸ ì½”ë“œëŠ” JVMì´ ì„¤ì¹˜ëœ ì–´ë–¤ í”Œë«í¼ì—ì„œë“  ì‹¤í–‰ ê°€ëŠ¥í•˜ë‹¤.

ê·¸ëŸ¬ë‚˜ ì´ ë°©ì‹ì€ ì†ŒìŠ¤ ì½”ë“œê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì»´íŒŒì¼ì„ í•˜ê³  ì‹¤í–‰ ì‹œì¼œì•¼ ë˜ê¸° ë•Œë¬¸ì— ì´ˆê¸° ë¹Œë“œ ì‹œê°„ì´ ê¸¸ì–´ì§ˆ ìˆ˜ ìˆë‹¤.

ì»´íŒŒì¼ëœ `.class` íŒŒì¼ì€ í´ë˜ìŠ¤ ë¡œë”(Class Loader)ì— ì˜í•´ JVM ë©”ëª¨ë¦¬ ì˜ì—­ì¸ ëŸ°íƒ€ì„ ë°ì´í„° ì˜ì—­(Runtime Data Area)ë¡œ ë¡œë“œëœë‹¤.

ì´í›„ ì‹¤í–‰ ì—”ì§„(Execution Engine)ì´ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰ ê°€ëŠ¥í•œ ê¸°ê³„ì–´ë¡œ ë³€í™˜í•˜ì—¬ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•œë‹¤.

### JVM ë©”ëª¨ë¦¬ êµ¬ì¡°

JVMì€ ìë°” í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ë•Œ ë©”ëª¨ë¦¬ë¥¼ ë‹¤ìŒê³¼ ê°™ì€ ì£¼ìš” ì˜ì—­ìœ¼ë¡œ ë‚˜ëˆ  ê´€ë¦¬í•œë‹¤.
ê° ì˜ì—­ì€ íŠ¹ì • ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ìŠ¤ë ˆë“œ ê°„ ê³µìœ  ì—¬ë¶€ë‚˜ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ëŒ€ìƒ ì—¬ë¶€ì— ë”°ë¼ ì—­í• ì´ ë‚˜ë‰œë‹¤.

![](/assets/images/Drawing Java-Memory-Structure-JVM 2025-04-06 16.41.26.excalidraw.png)

| ë©”ëª¨ë¦¬ ì˜ì—­                                | ì„¤ëª…                                         | íŠ¹ì§•                           |
| ------------------------------------- | ------------------------------------------ | ---------------------------- |
| **ë©”ì†Œë“œ ì˜ì—­ (Method Area)**              | í´ë˜ìŠ¤ ì •ë³´, ì •ì  ë³€ìˆ˜, ìƒìˆ˜, ë©”ì„œë“œ ë°ì´í„°, ë°”ì´íŠ¸ ì½”ë“œ ë“±ì´ ì €ì¥ë¨. | ëª¨ë“  ìŠ¤ë ˆë“œê°€ ê³µìœ . JVM ì‹œì‘ ì‹œ ìƒì„±.     |
| **í™ (Heap)**                          | ê°ì²´ì™€ ë°°ì—´ ê°™ì€ ë™ì  ë°ì´í„°ê°€ ì €ì¥ë¨.                     | ê°€ë¹„ì§€ ì»¬ë ‰ì…˜(GC)ì´ ê´€ë¦¬. ëª¨ë“  ìŠ¤ë ˆë“œê°€ ê³µìœ . |
| **ìŠ¤íƒ (Stack)**                        | ë©”ì„œë“œ í˜¸ì¶œ ì‹œ ì§€ì—­ ë³€ìˆ˜, ë§¤ê°œë³€ìˆ˜, í˜¸ì¶œ ì •ë³´(ë¦¬í„´ ì£¼ì†Œ ë“±)ê°€ ì €ì¥ë¨. | ìŠ¤ë ˆë“œë³„ ìƒì„±. LIFO êµ¬ì¡°.            |
| **PC ë ˆì§€ìŠ¤í„° (PC Register)**             | í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ JVM ëª…ë ¹ì–´ì˜ ì£¼ì†Œë¥¼ ì €ì¥.                  | ìŠ¤ë ˆë“œë³„ ìƒì„±. ë§¤ìš° ë¹ ë¥¸ ì ‘ê·¼.           |
| **ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ìŠ¤íƒ (Native Method Stack)** | ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œ í˜¸ì¶œ ì‹œ ì‚¬ìš©ë˜ëŠ” ìŠ¤íƒ. C/C++ ì½”ë“œ ì‹¤í–‰ ì‹œ í™œìš©.   | ìŠ¤ë ˆë“œë³„ ìƒì„±.                     |

### Method Area

JVMì´ ì‹œì‘ë  ë•Œ ìƒì„±ë˜ë©°, í”„ë¡œê·¸ë¨ ì¢…ë£Œ ì‹œê¹Œì§€ ìœ ì§€ëœë‹¤.
ë°”ì´íŠ¸ ì½”ë“œê°€ ì´ ì˜ì—­ì— ì €ì¥ëœë‹¤.

- ì €ì¥ ë°ì´í„°:
	- **í´ë˜ìŠ¤ ì •ë³´**: í´ë˜ìŠ¤ êµ¬ì¡°, ë©”ì„œë“œ, í•„ë“œ ë“±ì˜ ë©”íƒ€ë°ì´í„°
	- **ì •ì  ë³€ìˆ˜(`static`)**: í´ë˜ìŠ¤ì˜ ì •ì  ë©¤ë²„ ë³€ìˆ˜
	- **ìƒìˆ˜ í’€**: ë¬¸ìì—´ ë¦¬í„°ëŸ´, `final` ë³€ìˆ˜ ë“±
	- **ë©”ì„œë“œ ë°”ì´íŠ¸ ì½”ë“œ**: ì»´íŒŒì¼ëœ ë©”ì„œë“œ ì½”ë“œ.

Java 8 ì´í›„ `Metaspace`ë¡œ ëŒ€ì²´ë˜ì—ˆìœ¼ë©°, ì´ëŠ” ë„¤ì´í‹°ë¸Œ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì ìœ¼ë¡œ í™•ì¥ ê°€ëŠ¥í•˜ë‹¤.
ëª¨ë“  ìŠ¤ë ˆë“œê°€ ê³µìœ í•˜ë¯€ë¡œ ë™ê¸°í™”ê°€ í•„ìš”í•  ìˆ˜ ìˆë‹¤.

### Heap

ë™ì ìœ¼ë¡œ ìƒì„±ëœ ê°ì²´ì™€ ë°°ì—´ì´ ì €ì¥ë˜ëŠ” ì˜ì—­ì´ë‹¤.
`new` í‚¤ì›Œë“œë¡œ ìƒì„±ëœ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ëŠ” í™ì— í• ë‹¹ëœë‹¤.

í•´ë‹¹ ê°ì²´ê°€ ì†Œë©¸ë˜ê¸° ì „ì´ë‚˜ GC(Garbage Collector)ê°€ ì •ë¦¬í•˜ê¸° ì „ê¹Œì§€ ìœ ì§€ë˜ëŠ” ì˜ì—­ìœ¼ë¡œ ì‰½ê²Œ ì†Œë©¸ë˜ëŠ” ë°ì´í„°ê°€ ì•„ë‹ˆë‹¤.

- GCì˜ ëŒ€ìƒì´ ë˜ëŠ” ê³µê°„ì´ë©° íš¨ìœ¨ì ì¸ GCë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ 5ê°€ì§€ ì˜ì—­ìœ¼ë¡œ ë‚˜ë‰˜ê²Œ ëœë‹¤.
	- **Young Generation**:
		- **Eden Space**: ìƒˆ ê°ì²´ê°€ ì²˜ìŒ ìƒì„±ë˜ëŠ” ê³³
		- **Survivor Spaces**(S0, S1): Minor GC í›„ ì‚´ì•„ë‚¨ì€ ê°ì²´ê°€ ì´ë™
	- **Old Generation**(Tenured): ì˜¤ë˜ëœ ê°ì²´ê°€ ì €ì¥ë¨.
	- **Permanent Generation**(Java 7ê¹Œì§€, ì´í›„ Metaspaceë¡œ ëŒ€ì²´): í´ë˜ìŠ¤ ë©”íƒ€ë°ì´í„° ì €ì¥
- í™ì€ GCì˜ ì£¼ìš” ëŒ€ìƒì´ë©°, ë” ì´ìƒ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ë¥¼ ì •ë¦¬í•˜ì—¬ ë©”ëª¨ë¦¬ë¥¼ íšŒìˆ˜í•œë‹¤.
	- Minor GC: Young Generationì—ì„œ ë°œìƒ
	- Major/Full GC: Old Generationê³¼ ì „ì²´ í™ì„ ëŒ€ìƒìœ¼ë¡œ í•¨

ëª¨ë“  ìŠ¤ë ˆë“œê°€ ê³µìœ í•˜ë¯€ë¡œ ë™ê¸°í™”ê°€ í•„ìš”í•˜ë‹¤.

### Stack

ê° ìŠ¤ë ˆë“œë§ˆë‹¤ ë…ë¦¬ì ìœ¼ë¡œ ìƒì„±ë˜ë©°, ë©”ì„œë“œ í˜¸ì¶œ ì‹œë§ˆë‹¤ í”„ë ˆì„(Frame)ì´ ìƒì„±ë˜ì–´ ìŠ¤íƒì— ìŒ“ì¸ë‹¤.

- í”„ë ˆì„ êµ¬ì„±:
	- ì§€ì—­ ë³€ìˆ˜ ë°°ì—´: ë©”ì„œë“œì˜ ì§€ì—­ ë³€ìˆ˜ì™€ ë§¤ê°œë³€ìˆ˜
	- í”¼ì—°ì‚°ì ìŠ¤íƒ: ì—°ì‚° ì¤‘ê°„ ê²°ê³¼ ì €ì¥
	- í”„ë ˆì„ ë°ì´í„°: ë©”ì„œë“œ í˜¸ì¶œ ì •ë³´(ë¦¬í„´ ì£¼ì†Œ ë“±)

ë©”ì„œë“œ í˜¸ì¶œì´ ì¢…ë£Œë˜ë©´ í•´ë‹¹ í”„ë ˆì„ì´ ìŠ¤íƒì—ì„œ ì œê±°ë˜ê³ , ì§€ì—­ ë³€ìˆ˜ëŠ” ì†Œë©¸ëœë‹¤.
ì°¸ì¡°í˜• ë³€ìˆ˜(ì˜ˆ: ê°ì²´ ì°¸ì¡°)ëŠ” ìŠ¤íƒì— ì €ì¥ë˜ì§€ë§Œ, ì‹¤ì œ ê°ì²´ëŠ” í™ì— ì €ì¥ëœë‹¤.

ìŠ¤ë ˆë“œë³„ë¡œ ë…ë¦½ì ì´ë¯€ë¡œ ë™ê¸°í™”ê°€ í•„ìš” ì—†ë‹¤.

### PC Register

- ìŠ¤ë ˆë“œë³„ë¡œ ìƒì„±ë˜ë©°, í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ JVM ëª…ë ¹ì–´ì˜ ì£¼ì†Œë¥¼ ì €ì¥í•œë‹¤.
- JVMì´ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ë•Œ ë‹¤ìŒì— ì‹¤í–‰í•  ëª…ë ¹ì–´ ìœ„ì¹˜ë¥¼ ì¶”ì í•œë‹¤.
- ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ ì¤‘ë‹¨(ì˜ˆ: ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­) ì‹œ í˜„ì¬ ìƒíƒœë¥¼ ì €ì¥í•˜ì—¬ ì¬ê°œ ì‹œ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì—ì„œ ì‹¤í–‰ì„ ê³„ì†í•  ìˆ˜ ìˆë‹¤.

### Native Method Stack

- Javaê°€ ì•„ë‹Œ ë„¤ì´í‹°ë¸Œ ì–¸ì–´(`C`, `C++` ë“±)ë¡œ ì‘ì„±ëœ ë©”ì„œë“œë¥¼ ì‹¤í–‰í•  ë•Œ ì‚¬ìš©ëœë‹¤.
- JNI(Native Method Interface)ë¥¼ í†µí•´ í˜¸ì¶œëœ ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œì˜ í˜¸ì¶œ ìŠ¤íƒì„ ê´€ë¦¬í•œë‹¤.
- ìŠ¤ë ˆë“œë³„ë¡œ ë…ë¦½ì ìœ¼ë¡œ ìƒì„±ëœë‹¤.

### Execution Engine

í´ë˜ìŠ¤ ë¡œë”ê°€ ë¡œë“œí•œ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰ ê°€ëŠ¥í•œ ê¸°ê³„ì–´ë¡œ ë³€í™˜í•˜ì—¬ ì‹¤í–‰í•œë‹¤.

- êµ¬ì„±:
	- **Interpreter**: ë°”ì´íŠ¸ ì½”ë“œë¥¼ í•œ ì¤„ì”© í•´ì„í•˜ì—¬ ì‹¤í–‰. ì´ˆê¸° ì‹¤í–‰ ì†ë„ëŠ” ë¹ ë¥´ì§€ë§Œ ë°˜ë³µ ì‹¤í–‰ ì‹œ ë¹„íš¨ìœ¨ì 
	- **JIT(Just-In-Time) Compiler**: ìì£¼ ì‹¤í–‰ë˜ëŠ” ì½”ë“œë¥¼ ëŸ°íƒ€ì„ì— ê¸°ê³„ì–´ë¡œ ì»´íŒŒì¼í•˜ì—¬ ìºì‹±. ì´í›„ ì‹¤í–‰ ì†ë„ê°€ ë¹¨ë¼ì§„ë‹¤.
	- **Garbage Collector**: ë” ì´ìƒ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ë¥¼ í™ì—ì„œ ì œê±°í•œë‹¤.

í™ê³¼ Method AreaëŠ” ìŠ¤ë ˆë“œ ê°„ ê³µìœ ë˜ë¯€ë¡œ ë™ê¸°í™” ë§¤ì»¤ë‹ˆì¦˜ì´ í•„ìš”í•˜ë‹¤.
`synchronized` í‚¤ì›Œë“œë‚˜ `Lock` ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ê¸°í™” ì²˜ë¦¬.

### Native Method Interface (JNI)

Java ì½”ë“œì™€ ë„¤ì´í‹°ë¸Œ ì½”ë“œ(`C`/`C++` ë“±) ê°„ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” í”„ë ˆì„ì›Œí¬.
ì„±ëŠ¥ ìµœì í™”, ê¸°ì¡´ `C` ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©í•˜ëŠ” ìš©ë„ì´ë‹¤.

- Java ì½”ë“œì—ì„œ `native` í‚¤ì›Œë“œë¡œ ì„ ì–¸ëœ ë©”ì„œë“œë¥¼ í˜¸ì¶œ
- JNIê°€ í•´ë‹¹ ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œë¥¼ ì°¾ì•„ ì‹¤í–‰
- ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œëŠ” ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ìŠ¤íƒì„ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰

### Native Method Libraries

JNIê°€ í˜¸ì¶œí•˜ëŠ” ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œì˜ êµ¬í˜„ì²´ê°€ í¬í•¨ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬.

- `.dll` (Windows), `.so` (Linux) ë“±ì˜ ë™ì  ë¼ì´ë¸ŒëŸ¬ë¦¬ í˜•íƒœë¡œ ì œê³µ
- JVMì€ `System.loadLibrary()`ë¥¼ í†µí•´ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¡œë“œí•œë‹¤.

### Javaì˜ ì‹¤í–‰ê³¼ ê° ë©”ëª¨ë¦¬ ì˜ì—­

Java í”„ë¡œê·¸ë¨ì˜ ìƒëª… ì£¼ê¸°ë¥¼ ë‹¨ê³„ë³„ë¡œ ì‚´í´ë³´ë©° ê° ë©”ëª¨ë¦¬ ì˜ì—­ì´ ì–´ë–»ê²Œ í™œìš©ë˜ëŠ”ì§€ ë¶„ì„í•œë‹¤.

1. **ì†ŒìŠ¤ ì½”ë“œ ì‘ì„± ë° ì»´íŒŒì¼**:
	- `.java` íŒŒì¼ì„ ì‘ì„±í•˜ê³  `javac`ë¡œ ì»´íŒŒì¼í•˜ì—¬ `.class` íŒŒì¼(ë°”ì´íŠ¸ ì½”ë“œ) ìƒì„±.
	- ë°”ì´íŠ¸ ì½”ë“œëŠ” í”Œë«í¼ ë…ë¦½ì ì´ë©°, JVMì´ ì´í•´í•  ìˆ˜ ìˆëŠ” ì¤‘ê°„ ì–¸ì–´.
2. **Class Loading**:
	- Class Loaderê°€ `.class` íŒŒì¼ì„ ì½ì–´ Method Areaì— í´ë˜ìŠ¤ ì •ë³´(ë©”íƒ€ ë°ì´í„°, ë°”ì´íŠ¸ ì½”ë“œ ë“±)ë¥¼ ë¡œë“œí•œë‹¤.
	- ì •ì  ë³€ìˆ˜(`static`)ë„ Method areaì— í• ë‹¹í•œë‹¤.
3. **í”„ë¡œê·¸ë¨ ì‹¤í–‰**:
	- Execution Engineì´ ë°”ì´íŠ¸ ì½”ë“œë¥¼ í•´ì„/ì»´íŒŒì¼í•˜ì—¬ ì‹¤í–‰í•œë‹¤.
	- `main` ë©”ì„œë“œ í˜¸ì¶œ ì‹œ ìŠ¤ë ˆë“œê°€ ìƒì„±ë˜ê³ , í•´ë‹¹ ìŠ¤ë ˆë“œì˜ Stackì— `main` ë©”ì„œë“œ í”„ë ˆì„ì´ ìƒì„±ëœë‹¤.
	- PC RegisterëŠ” í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ëª…ë ¹ì–´ ì£¼ì†Œë¥¼ ì¶”ì í•œë‹¤.
4. **ê°ì²´ ìƒì„±**: 
	- `new` í‚¤ì›Œë“œë¡œ ê°ì²´ë¥¼ ìƒì„±í•˜ë©´ Heapì— ê°ì²´ê°€ í• ë‹¹ëœë‹¤.
	- ê°ì²´ ì°¸ì¡°ëŠ” Stackì˜ ì§€ì—­ ë³€ìˆ˜ë¡œ ì €ì¥ëœë‹¤.
5. **ë©”ì„œë“œ í˜¸ì¶œ**:
	- ë©”ì„œë“œ í˜¸ì¶œ ì‹œ ìƒˆë¡œìš´ í”„ë ˆì„ì´ Stackì— ì¶”ê°€ëœë‹¤.
	- ì§€ì—­ ë³€ìˆ˜ì™€ ë§¤ê°œë³€ìˆ˜ëŠ” í”„ë ˆì„ ë‚´ì— ì €ì¥ëœë‹¤.
	- ë©”ì„œë“œ ì¢…ë£Œ ì‹œ í”„ë ˆì„ì´ ì œê±°ë˜ê³  ì§€ì—­ ë³€ìˆ˜ëŠ” ì†Œë©¸ëœë‹¤.
6. **ìŠ¤ë ˆë“œ ë™ê¸°í™”**:
	- ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ Heap ë˜ëŠ” Method Areaì— ë°ì´í„°ë¥¼ ê³µìœ í•  ê²½ìš° ë™ê¸°í™” í•„ìš”
	- ì˜ˆ: `synchronized` ë¸”ë¡ì„ ì‚¬ìš©í•˜ì—¬ ê³µìœ  ìì›ì— ëŒ€í•œ ì ‘ê·¼ ì œì–´.
7. **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**:
	- ë” ì´ìƒ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ë¥¼ `Heap`ì—ì„œ ì œê±°í•œë‹¤.
	- Young Generationì—ì„œ ìì£¼ ë°œìƒí•˜ëŠ” Minor GCì™€ ì „ì²´ í™ì„ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” Full GCë¡œ ë‚˜ë‰œë‹¤.
8. **ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œ í˜¸ì¶œ**:
	- `native` ë©”ì„œë“œ í˜¸ì¶œ ì‹œ JNIë¥¼ í†µí•´ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¥¼ ì‹¤í–‰í•œë‹¤.
	- Native Method Stackì— í˜¸ì¶œ ì •ë³´ ì €ì¥
	- Native Method Librariesì—ì„œ í•´ë‹¹ ë©”ì„œë“œ êµ¬í˜„ì²´ ì‹¤í–‰

### íš¨ìœ¨ì ì¸ ë©”ëª¨ë¦¬ ê´€ë¦¬ ì „ëµ

1. **Heap ë©”ëª¨ë¦¬ ìµœì í™”**:
	- ë¶ˆí•„ìš”í•œ ê°ì²´ ìƒì„±ì„ ìµœì¡°í™”
	- ê°ì²´ í’€(Object Pool)ì„ ì‚¬ìš©í•˜ì—¬ ìì£¼ ìƒì„±/ì†Œë©¸ë˜ëŠ” ê°ì²´ ì¬ì‚¬ìš©.
	- ì ì ˆí•œ GC íŠœë‹(ì˜ˆ: `-Xms`, `-Xmx`ë¡œ ì´ˆê¸°/ìµœëŒ€ í™ í¬ê¸° ì„¤ì •)
2. **Stack ë©”ëª¨ë¦¬ ê´€ë¦¬**:
	- ê¹Šì€ ì¬ê·€ í˜¸ì¶œì„ í”¼í•˜ì—¬ StackOverflowError ë°©ì§€
	- ì§€ì—­ ë³€ìˆ˜ ì‚¬ìš©ì„ ìµœì†Œí™”í•˜ê³ , ë¶ˆí•„ìš”í•œ ë³€ìˆ˜ ì„ ì–¸ ì¤„ì´ê¸°
3. **Method Area ê´€ë¦¬**:
	- í´ë˜ìŠ¤ ë¡œë”© ìµœì†Œí™”: ë¶ˆí•„ìš”í•œ í´ë˜ìŠ¤ ë¡œë”© ë°©ì§€
	- Metaspace í¬ê¸° ì¡°ì • (ì˜ˆ: `-XX:MaxMetaspaceSize` ì˜µì…˜)
4. **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ìµœì í™”**:
	- Young/Old Generation í¬ê¸° ì¡°ì •
	- ì ì ˆí•œ GC ì•Œê³ ë¦¬ì¦˜ ì„ íƒ (ì˜ˆ: G1GC, CMS)
	- ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€: ê°•í•œ ì°¸ì¡°(Strong Reference) ëŒ€ì‹  ì•½í•œ ì°¸ì¡°(Weak Reference) ì‚¬ìš©
5. **ë„¤ì´í‹°ë¸Œ ë©”ëª¨ë¦¬ ê´€ë¦¬**:
	- ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œ í˜¸ì¶œ ì‹œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì£¼ì˜
	- JNIë¡œ í• ë‹¹ëœ ë„¤ì´í‹°ë¸Œ ë©”ëª¨ë¦¬ë¥¼ ì ì ˆíˆ í•´ì œ

## ğŸ“ŒJava ì‹¤í–‰ ì˜ˆì œ

>[!info] Native Method Libraries
>Native Method LibrariesëŠ” JDKì— í¬í•¨ëœ ê¸°ë³¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì•„ë‹ˆë¼ ì‚¬ìš©ìê°€ ë³„ë„ë¡œ ì‘ì„±í•˜ê±°ë‚˜ ì„œë“œíŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì œê³µ ë°›ì•„ì•¼ í•˜ëŠ” ë„¤ì´í‹°ë¸Œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤.

### í”„ë¡œì íŠ¸ ìƒì„±

Windowsì—ì„œ Gradle, Java 17, Groovy í”„ë¡œì íŠ¸ ìƒì„± í›„ í…ŒìŠ¤íŠ¸í•  ì˜ˆì •ì´ë‹¤.
`com.java.JVMMemoryExample` í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.

```java
import java.util.ArrayList;
import java.util.List;

public class JVMMemoryExample {
    // ì •ì  ë³€ìˆ˜: Method Areaì— ì €ì¥ë¨
    private static int staticCounter = 0;

    // ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜: Heapì— ì €ì¥ë¨ (ê°ì²´ê°€ ìƒì„±ë  ë•Œ)
    private String message;

    public JVMMemoryExample(String message) {
        this.message = message;
    }

    // ë©”ì„œë“œ: Method Areaì— ë°”ì´íŠ¸ ì½”ë“œë¡œ ì €ì¥ë¨
    public synchronized void incrementCounter() {
        // ì§€ì—­ ë³€ìˆ˜: Stackì— ì €ì¥ë¨
        int localVar = 10;
        // ë™ê¸°í™”: Heap/Method Areaì˜ ê³µìœ  ìì›(staticCounter)ì— ì ‘ê·¼
        staticCounter += localVar;
        System.out.println(Thread.currentThread().getName() + " - Counter: " + staticCounter);
    }

    // ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œ ì„ ì–¸: JNIë¥¼ í†µí•´ í˜¸ì¶œ
    public native void callNativeMethod();

    // ë„¤ì´í‹°ë¸Œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ: Native Method Librariesì—ì„œ ë¡œë“œ
    static {
        System.loadLibrary("NativeLib");
    }

    public static void main(String[] args) {
        System.out.println("í”„ë¡œê·¸ë¨ ì‹œì‘ - VisualVM ì—°ê²°ì„ ìœ„í•´ 15ì´ˆ ëŒ€ê¸°...");
        sleep(15000); // VisualVM ì—°ê²° ì‹œê°„ í™•ë³´

        System.out.println("1. ê°ì²´ ìƒì„± ë‹¨ê³„ ì‹œì‘ (5ì´ˆ ê°„ê²©)");
        List<JVMMemoryExample> examples = new ArrayList<>();
        for (int i = 0; i < 83; i++) {
            examples.add(new JVMMemoryExample("Object-" + i));
            if (i % 20 == 0) { // 20ê°œë§ˆë‹¤ ì¼ì‹œ ì •ì§€
                System.out.println("  ìƒì„±ëœ ê°ì²´: " + (i+1) + "ê°œ, 5ì´ˆ ëŒ€ê¸°...");
                sleep(5000);
            }
        }

        System.out.println("2. ê°œë³„ ê°ì²´ ìƒì„± ë° ìŠ¤ë ˆë“œ ì‹œì‘ (10ì´ˆ ëŒ€ê¸°)");
        JVMMemoryExample example1 = new JVMMemoryExample("Hello");
        JVMMemoryExample example2 = new JVMMemoryExample("World");
        sleep(5000); // ê°ì²´ ìƒì„± í›„ ëŒ€ê¸°

        JVMMemoryExample finalExample = example1;
        Thread t1 = new Thread(finalExample::incrementCounter, "Thread-1");

        JVMMemoryExample finalExample1 = example2;
        Thread t2 = new Thread(finalExample1::incrementCounter, "Thread-2");

        t1.start();
        t2.start();

        try {
            t1.join();
            t2.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        System.out.println("3. ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œ í˜¸ì¶œ ì „ 10ì´ˆ ëŒ€ê¸°...");
        sleep(10000);

        System.out.println("4. ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œ í˜¸ì¶œ");
        example1.callNativeMethod();
        sleep(5000); // ë„¤ì´í‹°ë¸Œ í˜¸ì¶œ í›„ ëŒ€ê¸°

        System.out.println("5. ì°¸ì¡° í•´ì œ ë° GC í˜¸ì¶œ ë‹¨ê³„");
        System.out.println("  example1, example2 ì°¸ì¡° í•´ì œ (5ì´ˆ ëŒ€ê¸°)");
        example1 = null;
        example2 = null;
        sleep(5000);

        System.out.println("  ì²« ë²ˆì§¸ GC í˜¸ì¶œ");
        System.gc();
        sleep(10000); // GC í›„ ë©”ëª¨ë¦¬ ë³€í™” ê´€ì°°

        System.out.println("  examples ë¦¬ìŠ¤íŠ¸ í´ë¦¬ì–´ (5ì´ˆ ëŒ€ê¸°)");
        examples.clear();
        sleep(5000);

        System.out.println("  ë‘ ë²ˆì§¸ GC í˜¸ì¶œ");
        System.gc();
        sleep(10000); // GC í›„ ë©”ëª¨ë¦¬ ë³€í™” ê´€ì°°

        System.out.println("6. í”„ë¡œê·¸ë¨ ì¢…ë£Œ ëŒ€ê¸° (30ì´ˆ)");
        sleep(30000);
    }

    private static void sleep(long millis) {
        try {
            Thread.sleep(millis);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

### NativeLib ìƒì„±

`NativeLib`ì„ ìƒì„±í•´ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê¹Œì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.
ì´ëŠ” JNI(Java Native Interface)ë¥¼ ì‚¬ìš©í•˜ì—¬ `C`/`C++` ì½”ë“œë¥¼ ì‘ì„±í•˜ê³ , ì´ë¥¼ ë™ì  ë¼ì´ë¸ŒëŸ¬ë¦¬ (`.dll`, `.so`, `.dylib`)ë¡œ ì»´íŒŒì¼ í•˜ëŠ” ê³¼ì •ì„ í¬í•¨í•œë‹¤.

#### ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œ í—¤ë” íŒŒì¼ ìƒì„±

1. `JVMMemoryExample` í´ë˜ìŠ¤ë¥¼ ì»´íŒŒì¼í•œë‹¤.

```bash
javac JVMMemoryExample.java

# ì»´íŒŒì¼ë¶€í„° ì¸ì½”ë”© ì˜¤ë¥˜... íŒŒì¼ì€ UTF-8, javacëŠ” ê¸°ë³¸ ms-949
# ì¸ì½”ë”© ì˜µì…˜ ì¶”ê°€í•´ì„œ í…ŒìŠ¤íŠ¸
javac -encoding UTF-8 JVMMemoryExample.java
```

2. `javac -h` ëª…ë ¹ì–´ë¡œ í—¤ë” íŒŒì¼ì„ ìƒì„±

```bash
javac -h . JVMMemoryExample.java

# ì¸ì½”ë”©...
javac -encoding UTF-8 -h . JVMMemoryExample.java

# JVMMemoryExample.h ë¼ëŠ” íŒŒì¼ì´ ìƒì„±ëœë‹¤. ë‚´ìš©ì€ ì•„ë˜ì™€ ê°™ì€ íŒŒì¼ì´ ë§Œë“¤ì–´ì§„ë‹¤.
# JNIEXPORT void JNICALL Java_JVMMemoryExample_callNativeMethod(JNIEnv *, jobject);
```

#### C ì½”ë“œ ì‘ì„±

`NativeLib.c` íŒŒì¼ì„ ìƒì„±í•˜ê³  ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œë¥¼ êµ¬í˜„í•œë‹¤.

```c
#include <jni.h>
#include <stdio.h>
#include "JVMMemoryExample.h"

JNIEXPORT void JNICALL Java_JVMMemoryExample_callNativeMethod(JNIEnv *env, jobject obj) {
    printf("ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì—ˆìŠµë‹ˆë‹¤!\n");
}
```

#### ë™ì  ë¼ì´ë¸ŒëŸ¬ë¦¬ ì»´íŒŒì¼

MinGWë¥¼ ì‚¬ìš©í•œë‹¤.
Java í™˜ê²½ ë³€ìˆ˜ëŠ” ì„¤ì •ëë‹¤ê³  ê°€ì •í•œë‹¤.

`gcc` ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ SourceForgeì—ì„œ MinGW-w64 ë°”ì´ë„ˆë¦¬ ë°°í¬íŒì„ ë‹¤ìš´ë¡œë“œ ë°›ì•„ `C:\mingw-w64` í´ë” ì•„ë˜ì— ë°°ì¹˜í•˜ê³  í™˜ê²½ ë³€ìˆ˜ë¥¼ ë“±ë¡í–ˆë‹¤.

```text
C:\mingw-w64\
	mingw64\
		bin\ <- gcc.exe, g++.exe ë“±ì´ í¬í•¨ë¨
		include\
		lib\
		...
```

í™˜ê²½ ë³€ìˆ˜ ë“±ë¡ í›„ `gcc` ë²„ì „ í™•ì¸

```bash
gcc --version

# gcc (x86_64-posix-seh-rev0, Built by MinGW-W64 project) 8.1.0
# Copyright (C) 2018 Free Software Foundation, Inc.
```

ì´í›„ ì»´íŒŒì¼ ëª…ë ¹ì–´ ì‹¤í–‰í•˜ë©´ `NativeLib.dll` íŒŒì¼ì´ ìƒì„±ëœë‹¤.

```bash
gcc -I"%JAVA_HOME%\include" -I"%JAVA_HOME%\include\win32" -shared -o NativeLib.dll NativeLib.c
```

#### ë¼ì´ë¸ŒëŸ¬ë¦¬ ê²½ë¡œ ì„¤ì •

ìƒì„±ëœ `NativeLib.dll`ì„ `java.library.path`ì— ì¶”ê°€í•˜ê±°ë‚˜ IntelliJì—ì„œ ì‹¤í–‰ ì‹œ ê²½ë¡œë¥¼ ì§€ì •í•œë‹¤.
`Run > Edit Configurations > VM options`ì— ì¶”ê°€í•´ì„œ ì‹¤í–‰í•œë‹¤.

```bash
-Djava.library.path=NativeLib_íŒŒì¼_ê²½ë¡œ
# ì˜ˆ: -Djava.library.path=C:\libs
```

#### ì‹¤í–‰ ê²°ê³¼

ì¼ë°˜ì ì¸ ì‹¤í–‰ ê²°ê³¼

```bash
Thread-1 - Counter: 10
Thread-2 - Counter: 20
ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì—ˆìŠµë‹ˆë‹¤!

BUILD SUCCESSFUL in 444ms
```

ì´ ì‹¤í–‰ì„ í†µí•´ JVM ë©”ëª¨ë¦¬ êµ¬ì¡°ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ì„  `VisualVM`, `JConsole` ë˜ëŠ” JVM ë¡œê·¸ ì˜µì…˜ `-XLog:gc`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

### VisualVMìœ¼ë¡œ JVM ë©”ëª¨ë¦¬ êµ¬ì¡° í™•ì¸

ë­”ê°€ ì´ë¦„ë¶€í„° ëˆˆìœ¼ë¡œ í™•ì¸í•˜ê¸° ì¢‹ì„ ê²ƒ ê°™ì•„ì„œ JDKì— í¬í•¨ë˜ì–´ ìˆëŠ” ê°•ë ¥í•œ ëª¨ë‹ˆí„°ë§ ë„êµ¬ VisualVMìœ¼ë¡œ JVMì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰, ìŠ¤ë ˆë“œ ìƒíƒœ, GC ë™ì‘ ë“±ì„ í™•ì¸í•œë‹¤.

JDK ì„¤ì¹˜ ê²½ë¡œì—ì„œ `jvisualvm.exe`ì´ ìˆë‹¤ë©´ ì‹¤í–‰í•œë‹¤.
ì—†ë‹¤ë©´ ì§ì ‘ VisualVMì„ ë‹¤ìš´ë¡œë“œ ë°›ëŠ”ë‹¤.
- OpenJDKë¥¼ ì‚¬ìš©í•˜ê³  ìˆê³  `jvisualvm.exe`ê°€ í¬í•¨ë˜ì§€ ì•Šì€ ë°°í¬íŒì¸ ë“¯.
- https://visualvm.github.io/download.html ì§ì ‘ VisualVMì„ ë‹¤ìš´ë¡œë“œ ë°›ì•˜ë‹¤.
- ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•´ì„œ ë³„ë„ ìœ„ì¹˜ì— ë°°ì¹˜í•œ í›„ `visualvm_2110\bin\visualvm.exe`ë¥¼ ì‹¤í–‰í–ˆë‹¤.

ì‹¤í–‰ í›„ ìë™ìœ¼ë¡œ JDKê°€ ê°ì§€ë˜ì§€ë§Œ ì§ì ‘ JDKë¥¼ ì§€ì •í•˜ì—¬ VisualVMì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.

```bash
# VisualVMì´ ì„¤ì¹˜ëœ ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•œ í›„ JDK ê²½ë¡œë¥¼ ì§€ì •í•˜ì—¬ VisualVMì„ ì‹¤í–‰
# ì˜ˆì‹œ ê²½ë¡œì´ë¯€ë¡œ ì‹¤ì œ ê²½ë¡œë¥¼ ì‚¬ìš©í•œë‹¤.
visualvm.exe --jdkhome "C:\Program Files\java\openlogic-openjdk-17.0.14+7-windows-x64"
```

![](/assets/images/Pasted image 20250406205638.png)

ì‹¤í–‰ í›„ ì¢Œì¸¡ íŒ¨ë„ì—ì„œ JVMMemoryExampleì„ í™•ì¸í•  ìˆ˜ ìˆê³  ê° íƒ­ì—ì„œ í•„ìš”í•œ ì •ë³´ë¥¼ ì°¾ì•„ í™•ì¸í•´ë³¼ ìˆ˜ ìˆë‹¤.

ì‹¤í–‰ ì˜ˆì œë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ VisualVMì˜ ìƒë‹¨ íˆ´ë°”ì—ì„œ `Tools > Plugins > Available Plugins`ì„ ë³´ë©´ `Visual GC`ê°€ ìˆë‹¤. ì´ê±¸ ì„¤ì¹˜í•˜ê³  í™•ì¸í•´ë³¸ë‹¤.

![](/assets/images/Pasted image 20250406221818.png)

## ğŸ¯ê²°ë¡ 

JVMì˜ ë©”ëª¨ë¦¬ êµ¬ì¡°ë¥¼ ì´í•´í•˜ê³  í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë  ë•Œ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•´ë³¼ ìˆ˜ ìˆì—ˆë‹¤.
VisualVMì€ ë‹¤ì‹œ í•œ ë²ˆ ë‹¤ë¤„ì•¼ê² ë‹¤.

## âš™ï¸EndNote

### Garbage Collector

ê°€ë¹„ì§€ ì»¬ë ‰í„° GCëŠ” ë” ì´ìƒ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ë¥¼ í™ì—ì„œ ì œê±°í•˜ì—¬ ë©”ëª¨ë¦¬ë¥¼ íšŒìˆ˜í•˜ëŠ” ì—­í• ì„ ê°–ëŠ”ë‹¤.

#### ì¢…ë¥˜

- Serial GC: ë‹¨ì¼ ìŠ¤ë ˆë“œë¡œ GC ìˆ˜í–‰. ì†Œê·œëª¨ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì í•©
- Parallel GC: ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¡œ GC ìˆ˜í–‰. ì²˜ë¦¬ëŸ‰ ì¤‘ì 
- CMS (Concurrent Mark-Sweep): ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤ë ˆë“œì™€ ë™ì‹œì— ì‹¤í–‰. ë‚®ì€ ì§€ì—° ì‹œê°„ ì¤‘ì 
- G1GC: ëŒ€ê·œëª¨ í™ì—ì„œ íš¨ìœ¨ì ì¸ GC. Java 9ë¶€í„° ê¸°ë³¸ GC.

#### ë™ì‘

1. Mark: ë” ì´ìƒ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ ì‹ë³„
2. Sweep: ì‹ë³„ëœ ê°ì²´ ì œê±°
3. Compact (ì¼ë¶€ GC): ë©”ëª¨ë¦¬ ì¡°ê°í™” ë°©ì§€

#### ìµœì í™” íŒ

- GC ë¡œê·¸ ë¶„ì„ (`-Xlog:gc` ì˜µì…˜)
- ì• í”Œë¦¬ì¼€ì´ì…˜ íŠ¹ì„±ì— ë§ëŠ” GC ì„ íƒ
- ë¶ˆí•„ìš”í•œ ê°ì²´ ìƒì„± ë°©ì§€